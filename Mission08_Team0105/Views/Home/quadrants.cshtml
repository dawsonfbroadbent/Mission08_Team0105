@* Bind this view to a List of Task objects passed from the HomeController *@
@model List<Mission08_Team0105.Models.Task>

@{
    ViewData["Title"] = "Time Management Matrix";
}

<style>
    .vertical-text {
        writing-mode: vertical-rl; /* Turns the text sideways */
        transform: rotate(180deg); /* Flips it so it reads bottom-to-top */
        letter-spacing: 2px;
    }

    .task-card {
        background-color: #ffffff;
        border: 2px solid #000;
        box-shadow: 2px 2px 0px rgba(0,0,0,0.1);
    }
</style>

<div class="container mt-4 mb-5">
    <div class="border border-dark border-4 rounded-3 overflow-hidden" style="background-color: #eaddb4; color: #000;">

        <div class="row g-0 border-bottom border-dark border-4">
            <div class="col-12 text-center p-3">
                <h2 class="fw-bold text-uppercase mb-0">Stephen Covey's Time Management Matrix</h2>
            </div>
        </div>

        <div class="row g-0 border-bottom border-dark border-2 text-center fw-bold fs-5 text-uppercase">
            <div class="col-1 border-end border-dark border-2"></div> <div class="col border-end border-dark border-2 p-2">Urgent</div>
            <div class="col p-2">Not Urgent</div>
        </div>

        <div class="row g-0 border-bottom border-dark border-2">
            <div class="col-1 border-end border-dark border-2 d-flex align-items-center justify-content-center p-2">
                <span class="vertical-text fw-bold fs-5 text-uppercase">Important</span>
            </div>

            <div class="col border-end border-dark border-2 p-3">
                <div class="text-center mb-3">
                    <h4 class="fw-bold mb-0">Quadrant 1</h4>
                    <small>Crises<br />Pressing Problems<br />Projects with Deadlines</small>
                </div>

                @* Loop through the Model, filtering for tasks that belong in Q1 AND are not yet completed *@
                @foreach (var task in Model.Where(t => t.Quadrant == 1 && !t.Completed))
                {
                    <div class="task-card p-2 mb-2 rounded">
                        <h6 class="fw-bold mb-1">@task.Task1</h6>
                        <p class="small mb-2 text-muted">
                            <strong>Due:</strong> @(task.DueDate?.ToString("MM/dd/yyyy") ?? "None") <br />
                            <strong>Category:</strong> @task.Category?.Name
                        </p>
                        <div class="d-flex justify-content-end gap-1">
                            @* Action buttons that pass the specific Task ID back to the Edit and Delete GET actions in the controller *@
                            <a asp-controller="Home" asp-action="Edit" asp-route-id="@task.Id" class="btn btn-warning btn-sm border-dark fw-bold">Edit</a>
                            <a asp-controller="Home" asp-action="Delete" asp-route-id="@task.Id" class="btn btn-danger btn-sm border-dark fw-bold">Delete</a>
                        </div>
                    </div>
                }
            </div>

            <div class="col p-3">
                <div class="text-center mb-3">
                    <h4 class="fw-bold mb-0">Quadrant 2</h4>
                    <small>Relationship Building<br />Planning<br />Recreation</small>
                </div>

                @* Loop through the Model, filtering for tasks that belong in Q2 AND are not yet completed *@
                @foreach (var task in Model.Where(t => t.Quadrant == 2 && !t.Completed))
                {
                    <div class="task-card p-2 mb-2 rounded">
                        <h6 class="fw-bold mb-1">@task.Task1</h6>
                        <p class="small mb-2 text-muted">
                            <strong>Due:</strong> @(task.DueDate?.ToString("MM/dd/yyyy") ?? "None") <br />
                            <strong>Category:</strong> @task.Category?.Name
                        </p>
                        <div class="d-flex justify-content-end gap-1">
                            <a asp-controller="Home" asp-action="Edit" asp-route-id="@task.Id" class="btn btn-warning btn-sm border-dark fw-bold">Edit</a>
                            <a asp-controller="Home" asp-action="Delete" asp-route-id="@task.Id" class="btn btn-danger btn-sm border-dark fw-bold">Delete</a>
                        </div>
                    </div>
                }
            </div>
        </div>

        <div class="row g-0">
            <div class="col-1 border-end border-dark border-2 d-flex align-items-center justify-content-center p-2">
                <span class="vertical-text fw-bold fs-5 text-uppercase">Not Important</span>
            </div>

            <div class="col border-end border-dark border-2 p-3">
                <div class="text-center mb-3">
                    <h4 class="fw-bold mb-0">Quadrant 3</h4>
                    <small>Interruptions<br />Some Phone Calls<br />Some Mail<br />Some Reports</small>
                </div>

                @* Loop through the Model, filtering for tasks that belong in Q3 AND are not yet completed *@
                @foreach (var task in Model.Where(t => t.Quadrant == 3 && !t.Completed))
                {
                    <div class="task-card p-2 mb-2 rounded">
                        <h6 class="fw-bold mb-1">@task.Task1</h6>
                        <p class="small mb-2 text-muted">
                            <strong>Due:</strong> @(task.DueDate?.ToString("MM/dd/yyyy") ?? "None") <br />
                            <strong>Category:</strong> @task.Category?.Name
                        </p>
                        <div class="d-flex justify-content-end gap-1">
                            <a asp-controller="Home" asp-action="Edit" asp-route-id="@task.Id" class="btn btn-warning btn-sm border-dark fw-bold">Edit</a>
                            <a asp-controller="Home" asp-action="Delete" asp-route-id="@task.Id" class="btn btn-danger btn-sm border-dark fw-bold">Delete</a>
                        </div>
                    </div>
                }
            </div>

            <div class="col p-3">
                <div class="text-center mb-3">
                    <h4 class="fw-bold mb-0">Quadrant 4</h4>
                    <small>Busy Work<br />Some Phone Calls<br />Some Mail<br />Time Wasters</small>
                </div>

                @* Loop through the Model, filtering for tasks that belong in Q4 AND are not yet completed *@
                @foreach (var task in Model.Where(t => t.Quadrant == 4 && !t.Completed))
                {
                    <div class="task-card p-2 mb-2 rounded">
                        <h6 class="fw-bold mb-1">@task.Task1</h6>
                        <p class="small mb-2 text-muted">
                            <strong>Due:</strong> @(task.DueDate?.ToString("MM/dd/yyyy") ?? "None") <br />
                            <strong>Category:</strong> @task.Category?.Name
                        </p>
                        <div class="d-flex justify-content-end gap-1">
                            <a asp-controller="Home" asp-action="Edit" asp-route-id="@task.Id" class="btn btn-warning btn-sm border-dark fw-bold">Edit</a>
                            <a asp-controller="Home" asp-action="Delete" asp-route-id="@task.Id" class="btn btn-danger btn-sm border-dark fw-bold">Delete</a>
                        </div>
                    </div>
                }
            </div>
        </div>

    </div>
</div>